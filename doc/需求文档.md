# 电气控制柜图论模型需求文档

## 1. 引言

本文档描述了将电气控制柜连接图纸转换为图论模型的需求，并详细说明了模型的构建、模拟和测试过程。该模型旨在模拟电柜内部的电气运行状态，并用于验证接线的正确性。

## 2. 电子表格数据

### 2.1 数据来源

输入数据来源于电子表格文件，其中每一行代表一个电气连接（edge），包含以下列：

*   **Consecutive number:** 连接的序号。
*   **Device (source) Name of target connection point (full):** 连接的起点vertex。
*   **Device (target) Name of target connection point (full):** 连接的终点vertex。
*   **Connection: Type designation:** 连接类型。
*   **Connection color / number:** 连接颜色和编号。
*   **Connection: Cross-section / diameter:** 连接的横截面/直径。
*   **Cables/conduits: codes in drawings:** 电缆/导管在图纸中的代码。
*   **connect Device identifier (complete):** 连接的设备标识符。
*   **Length (full):** 连接的长度。

### 2.2 数据处理

*   **关键列:**  "Device (source) Name of target connection point (full)" 和 "Device (target) Name of target connection point (full)" 两列定义了edge的起点和终点，"Connection number" 作为edge的唯一标识符。
*   **Vertex标记:**
    *   `=`: 表示功能。
    *   `+`: 表示位置。
    *   `-`: 表示器件或设备。
    *   `:`: 表示点。
    这些标记组合起来表示一个唯一的vertex。

## 3. 图论模型构建

### 3.1 Edge处理

*   **删除柜外edge:** 需要识别并删除连接到电柜外部的edge。
*   **保留特定edge:** 保留起点和终点 `+` 都是 `k1.` 的edge。

### 3.2 模拟元素

*   **A单元:**
    *   受数据库中的 `active` 字段控制。
    *   当 `active == true` 时，形成 `a1-a2` 的edge。
    *   当 `active == false` 时，该edge不存在。
*   **B单元:**
    *   `a1` 固定连接到 `DC24` 节点。
    *   `DC24`、`DC0`、`AC380U`、`AC380V`、`AC380W`、`AD220`、`ACN`、`PE` 是具备电压功能的点。
*   **D单元:**
    *   `d1` 连接到图论点。
    *   `d2` 连接到可以检查电压的 `SENS` 点。
    *   `SENS` 点可以获取图论中的电压信息。
*   **U单元:**
    *   与B单元类似，但 `u1` 的电压是变化的。
*   **RELAY单元:**
    *   线圈部分不通电。
    *   当线圈两端有电压电流时，切换触点edge状态。

### 3.3 电压处理

*   **电压电平:**
    *   380V 电压，分为 U、V、W、N、PE。
    *   设备输出 DC24 和 0V。
*   **阻值:**
    *   每个edge都有阻值。
    *   绝缘的阻值是无穷大。
    *   不需要可变阻值。
    *   AC的需要考虑交流阻抗。
*   **电压传输:** 如果图论连接到不同电压值，则建立通道回路，遵循欧姆定律。

## 4. 图论部署和驱动

*   部署新图后，可以驱动模拟单元，并读取电压。

## 5. 测试真值表

*   通过设置一些单元的状态，可以预测其他点的电压状态，并生成测试真值表。
*   将测试真值表与实物电柜的测试结果进行对比，以验证接线的正确性。

## 6. 未来扩展

*   可以考虑不固定电位点，设计几种电平，赋予给edge的vertex。